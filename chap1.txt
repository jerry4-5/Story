modified for merging and branching.